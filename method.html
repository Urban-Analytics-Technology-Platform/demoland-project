<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DemoLand - 4&nbsp; Methodology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./notes.html" rel="next">
<link href="./data_sources.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Methodology</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">DemoLand</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/ciupava/LandUseDemonstrator/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="./DemoLand.pdf" title="Download PDF" class="sidebar-tool px-1"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">DemoLand</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Intro</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_sources.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Sources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./method.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Methodology</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Notes</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#building-indicators" id="toc-building-indicators" class="nav-link active" data-scroll-target="#building-indicators"><span class="toc-section-number">4.1</span>  Building Indicators</a>
  <ul class="collapse">
  <li><a href="#accessibility-calculation" id="toc-accessibility-calculation" class="nav-link" data-scroll-target="#accessibility-calculation"><span class="toc-section-number">4.1.1</span>  Accessibility calculation</a></li>
  <li><a href="#air-quality-index" id="toc-air-quality-index" class="nav-link" data-scroll-target="#air-quality-index"><span class="toc-section-number">4.1.2</span>  Air quality index</a></li>
  <li><a href="#house-price" id="toc-house-price" class="nav-link" data-scroll-target="#house-price"><span class="toc-section-number">4.1.3</span>  House price</a></li>
  </ul></li>
  <li><a href="#explanatory-variables" id="toc-explanatory-variables" class="nav-link" data-scroll-target="#explanatory-variables"><span class="toc-section-number">4.2</span>  Explanatory variables</a>
  <ul class="collapse">
  <li><a href="#ons-population-estimates" id="toc-ons-population-estimates" class="nav-link" data-scroll-target="#ons-population-estimates"><span class="toc-section-number">4.2.1</span>  ONS population estimates</a></li>
  <li><a href="#workplace-population-by-industry" id="toc-workplace-population-by-industry" class="nav-link" data-scroll-target="#workplace-population-by-industry"><span class="toc-section-number">4.2.2</span>  Workplace population by industry</a></li>
  <li><a href="#corine-land-cover-classification" id="toc-corine-land-cover-classification" class="nav-link" data-scroll-target="#corine-land-cover-classification"><span class="toc-section-number">4.2.3</span>  CORINE Land Cover classification</a></li>
  <li><a href="#urban-morphometrics" id="toc-urban-morphometrics" class="nav-link" data-scroll-target="#urban-morphometrics"><span class="toc-section-number">4.2.4</span>  Urban morphometrics</a></li>
  <li><a href="#modelling-regression-analysis" id="toc-modelling-regression-analysis" class="nav-link" data-scroll-target="#modelling-regression-analysis"><span class="toc-section-number">4.2.5</span>  Modelling / regression analysis</a></li>
  </ul></li>
  <li><a href="#building-scenarios" id="toc-building-scenarios" class="nav-link" data-scroll-target="#building-scenarios"><span class="toc-section-number">4.3</span>  Building scenarios</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Methodology</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><em>add workflow (comprehensive of all the steps)</em></p>
<section id="building-indicators" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="building-indicators"><span class="header-section-number">4.1</span> Building Indicators</h2>
<section id="accessibility-calculation" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="accessibility-calculation"><span class="header-section-number">4.1.1</span> Accessibility calculation</h3>
<p><strong>1. Build time travel matrix (TTM)</strong></p>
<ul>
<li>get time table for public transport -&gt; GTFS data</li>
<li>get roads network -&gt; OSM data</li>
<li>generate network graph -&gt; OTP, routino, r5, etc</li>
<li>generate ttm for different modes, time (day of the year/week, time of the day), multi o single time</li>
</ul>
<p>r5</p>
<p><strong>2. Run accessibility analysis</strong></p>
<ul>
<li><p>get land use data or “supply” or “opportunities” (ex location of jobs, healthcare, shopping, education, population, leisure)</p></li>
<li><p>procedure for greenspaces</p></li>
<li><p>run <code>tracc</code> or <code>pysal/access</code> pr <code>rpy5</code> on the TTM</p></li>
</ul>
<p>in R could use <code>accessibility</code> from <a href="https://ipeagit.github.io/accessibility/articles/accessibility.html">ipeagit</a></p>
<blockquote class="blockquote">
<p>calculate active and passive accessibility levels using multiple accessibility metrics, such as cumulative opportunities (using either a travel cost cutoff or a travel cost interval), minimum travel cost to closest N number of activities, gravitational measures and different floating catchment area methods.</p>
</blockquote>
<p><strong>3. Indicator definition</strong></p>
<ol type="a">
<li>for jobs accessibility</li>
<li>for green spaces accessibility</li>
</ol>
</section>
<section id="air-quality-index" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="air-quality-index"><span class="header-section-number">4.1.2</span> Air quality index</h3>
<p>We develop an air quality index as a composite of <span class="math inline">\(PM_{2.5}\)</span>, <span class="math inline">\(PM_{10}\)</span>, <span class="math inline">\(NO_{2}\)</span> and <span class="math inline">\(SO_{2}\)</span> particle values derived from the UK AIR project run by DEFRA with data available as a 1km grid (https://uk-air.defra.gov.uk/data/pcm-data). The composite index follows the methodology of European Environmental Agency, reflecting the relative health risk associated to the exposure to particle intensities.</p>
<blockquote class="blockquote">
<p>The bands are based on the relative risks associated to short-term exposure to PM2.5, O3 and NO2, as defined by the World Health Organization in its report on the Health Risks of Air Pollution in Europe project (HRAPIE project report).</p>
<p>The relative risk of exposure to PM2.5 is taken as basis for driving the index, specifically the increase in the risk of mortality per 10 µg/m3 increase in the daily mean concentration of PM2.5.</p>
<p>Assuming linearity across the relative risks functions for O3 and NO2, we calculate the concentrations of these pollutants that pose an equivalent relative risk to a 10 µg/m3 increase in the daily mean of PM2.5.</p>
<p>For PM10 concentrations, a constant ratio between PM10 and PM2.5 of 1:2 is assumed, in line with the World Health Organization´s air quality guidelines for Europe.</p>
<p>For SO2, the bands reflect the limit values set under the EU Air Quality Directive.</p>
</blockquote>
<p>The relationship between <span class="math inline">\(PM_{2.5}\)</span> : <span class="math inline">\(PM_{10}\)</span> : <span class="math inline">\(NO_{2}\)</span> : <span class="math inline">\(O_{3}\)</span> : <span class="math inline">\(SO_{2}\)</span> is then equal to 1 : 2 : 4 : 5 : 10. The combined index can then be computed as <span class="math display">\[Q_{air} = \frac{PM_{2.5}}{1} + \frac{PM_{10}}{2} + \frac{NO_{2}}{4} + \frac{O_{3}}{5} + \frac{SO_{2}}{10}\]</span></p>
<p>Except for the <span class="math inline">\(O_{3}\)</span>, UK AIR reports all as a concentration in <span class="math inline">\(\mu g \cdot m^{-3}\)</span>. <span class="math inline">\(O_{3}\)</span> is reported as a number of days above a threshold of 120 <span class="math inline">\(\mu g \cdot m^{-3}\)</span> and cannot be used in this formula but even EEA omits data when unavailable so we shall be able to create the index based on 4 remaning measurements.</p>
<p>It shall also be considered that UK AIR is not representing a direct measurements but a model.</p>
<p>The data from the 1km grid are spatially interpolated to Output Area geometry. The index itself is computed on the grid.</p>
</section>
<section id="house-price" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="house-price"><span class="header-section-number">4.1.3</span> House price</h3>
<p>An optimal way of working with house prices in the modelling exercise like ours is to use price per sqm. However, those are not generally available at the level of Output Area or similar. Luckily, we can retrieve such data from the “<em>A new attribute-linked residential property price dataset for England and Wales 2011-2019</em>” project by Chi et al.&nbsp;available from <a href="https://dx.doi.org/10.5255/UKDA-SN-854240">10.5255/UKDA-SN-854240</a>. That contains individual house prices, total floor area and a resulting price per sqm resulting from a combination of Land Registry Price Paid Data and Domestic Energy Performance Certificates.</p>
<p>We use the data from years 2018-2019 and compute the mean price per sqm per output area. Given the data is not fully up-to-date, the modelling results will be presented as a percentual increase or decrease compared to the baseline value rather than in absolute values.</p>
</section>
</section>
<section id="explanatory-variables" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="explanatory-variables"><span class="header-section-number">4.2</span> Explanatory variables</h2>
<p>We use a set of explanatory variables describing the environment that can be changed to model different scenarios and have, at the same time, explanatory power to predict our four indicators.</p>
<section id="ons-population-estimates" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="ons-population-estimates"><span class="header-section-number">4.2.1</span> ONS population estimates</h3>
<p>We use the ONS population estimates on the OA level for mid-2020. The other data used in the project are generally reflecting the period 2018-2020, so we want to ensure we describe the compatible point in time. The dataset is retrieved from the <a href="https://www.ons.gov.uk/file?uri=/peoplepopulationandcommunity/populationandmigration/populationestimates/datasets/censusoutputareaestimatesinthenortheastregionofengland/mid2020sape23dt10d/sape23dt10dmid2020coaunformattedsyoaestimatesnortheast.xlsx">ONS</a>. Given it is reported on Output Area level, it can be simply joined.</p>
</section>
<section id="workplace-population-by-industry" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="workplace-population-by-industry"><span class="header-section-number">4.2.2</span> Workplace population by industry</h3>
<p>Workplace population is coming from the Census 2011 and is reported on Workplace Zone geometries. We use the data preprocessed in the Urban Grammar project that aggregated industries into following groups:</p>
<ul>
<li>A, B, D, E. Agriculture, energy and water</li>
<li>C. Manufacturing’, ’F. Construction</li>
<li>G, I. Distribution, hotels and restaurants</li>
<li>H, J. Transport and communication</li>
<li>K, L, M, N. Financial, real estate, professional and administrative activities</li>
<li>O,P,Q. Public administration, education and health</li>
<li>R, S, T, U. Other</li>
</ul>
<p>The data is then interpolated from Workplace Zones to Output Areas.</p>
</section>
<section id="corine-land-cover-classification" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="corine-land-cover-classification"><span class="header-section-number">4.2.3</span> CORINE Land Cover classification</h3>
<p>We use CORINE Land Cover Classification for 2018 distributed as polygons of contiguous areas belonging to the same classs. We use the data extracted for the Great Britain within the Urban Grammar project and interpolate the data onto Output Areas capturing a proportion of each OA covered by each class. We further filter out fully or nearly invariant classes and use only:</p>
<ul>
<li>Discontinuous urban fabric</li>
<li>Continuous urban fabric</li>
<li>Non-irrigated arable land</li>
<li>Industrial or commercial units</li>
<li>Green urban areas</li>
<li>Pastures</li>
<li>Sport and leisure facilities</li>
</ul>
</section>
<section id="urban-morphometrics" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="urban-morphometrics"><span class="header-section-number">4.2.4</span> Urban morphometrics</h3>
<p>Urban morphometrics offers a way of describing physical built environment (buildings, streets) in a set of measurements capturing different aspects of morphological elements. We directly use the set measured within the Urban Grammar project</p>
<p>TODO: remove some useless characters and describe it here.</p>
</section>
<section id="modelling-regression-analysis" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="modelling-regression-analysis"><span class="header-section-number">4.2.5</span> Modelling / regression analysis</h3>
</section>
</section>
<section id="building-scenarios" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="building-scenarios"><span class="header-section-number">4.3</span> Building scenarios</h2>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data_sources.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Sources</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./notes.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Notes</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>